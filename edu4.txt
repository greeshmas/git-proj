Branching
Modified version in branching.

